function _SearchFind(){let n=document.querySelector("#"+searchHeaderQHtmlBox.Name+" input").value.toLowerCase();userLogin.length>0&&(n="-"+userLogin+"-"+n);n.length>0&&(window.location.href="/i/"+n)}async function ApiUserBio(n){const t=await fetch(ApiUrl+"/Base/User/Bio?userLogin="+n,{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer "+Session.Token}});return t.ok===!0?await t.json():null}async function ApiUserSubscrib(n){const t=await fetch(ApiUrl+"/Base/User/Subscrib?userLogin="+n,{method:"POST",headers:{Accept:"application/json",Authorization:"Bearer "+Session.Token}});return t.ok===!0?await t.json():null}async function ApiArticleBookmarkGet(n){const t=await fetch(ApiUrl+"/RtInk/ArticleBookmark?urlShort="+n,{method:"GET",headers:{Authorization:"Bearer "+Session.Token}});return t.ok===!0?await t.json():null}async function ApiArticleBookmarkPost(n){const t=await fetch(ApiUrl+"/RtInk/ArticleBookmark?urlShort="+n,{method:"POST",headers:{Authorization:"Bearer "+Session.Token}});return t.ok}import{ApiUrl,PageHeadsBuild,Session}from"/PageComponents/Page/script.min.js";import{HeaderHtmlBox}from"/PageComponents/HeaderHtmlBox/script.min.js";import{HeaderDescriptionHtmlBox}from"/PageComponents/HeaderDescriptionHtmlBox/script.min.js";import{HeaderTitleDescriptionHtmlBox}from"/PageComponents/HeaderTitleDescriptionHtmlBox/script.js";import{SearchHeaderQHtmlBox}from"/PageComponents/SearchHeaderQHtmlBox/script.min.js";import{ArticlesHtmlBox}from"/PageComponents/ArticlesHtmlBox/script.min.js";let searchHeaderQHtmlBox=new SearchHeaderQHtmlBox,headerTitleDescriptionHtmlBox=new HeaderTitleDescriptionHtmlBox;PageHeadsBuild("News aggregator - RT",'RT - точка сбора самых интересных и актуальных новостей российских онлайн-медиа. "Картина дня" формируется автоматически на базе популярности материалов.');const iPageName="i",iPageUrl="/Pages/"+iPageName,iPageUrlContent=iPageUrl+"/content";let iPageCss=document.createElement("link");iPageCss.setAttribute("rel","stylesheet");iPageCss.setAttribute("href",iPageUrl+"/style.min.css");document.head.append(iPageCss);let search="",urlSrplit=document.URL.split("/");urlSrplit.length>4&&(search=decodeURIComponent(urlSrplit[4]));let typeApiPageI=0,userLogin="";if(search.length>0){let n=search.split("-");n.length>0&&(search[0]=="-"?(typeApiPageI=1,userLogin=n[1]):typeApiPageI=n.length==2&&n[1].length==0&&search[search.length-1]=="-"?2:3)}let headerHtmlBox=new HeaderHtmlBox,HeaderTitle="RT",headerDescriptionName="",placeholder="",subscribType=0;if(typeApiPageI==0)headerDescriptionName="NEWS",headerHtmlBox.PushMenuRow({icon:iPageUrlContent+"/search.png",href:"",id:"SearchBM",alt:"search"}),Session.RoleId==0?headerHtmlBox.PushMenuRow({icon:iPageUrlContent+"/location.png",href:"/locations",id:"LocationBM",alt:"location"}):headerHtmlBox.PushMenuRow({icon:iPageUrlContent+"/category.png",href:"/users",alt:"signin"});else if(typeApiPageI==1){if(HeaderTitle="",Session.RoleId>0){let n=await ApiUserBio(userLogin);if(subscribType=n.sbt,subscribType!=1){let n=iPageUrlContent+"/doubleCheckBlackBlack.png";subscribType==2?n=iPageUrlContent+"/doubleCheckBlackRed.png":subscribType==3?n=iPageUrlContent+"/doubleCheckRedBlack.png":subscribType==4&&(n=iPageUrlContent+"/doubleCheckRedRed.png");headerHtmlBox.PushMenuRow({icon:n,href:"",id:"SubsribB"})}else headerHtmlBox.PushMenuRow({icon:iPageUrlContent+"/add.png",href:""}),headerHtmlBox.PushMenuRow({icon:iPageUrlContent+"/settings.png",href:""})}if(search.split("-").length>2){let n=search.split("-");for(var i=2;i<n.length;i++)placeholder+=n[i]+" ";placeholder=placeholder.trim().toUpperCase()}headerHtmlBox.PushMenuRow({icon:iPageUrlContent+"/search.png",href:"",id:"SearchBM"});let n="/";Session.RoleId>0&&(n="/users");headerHtmlBox.PushMenuRow({icon:iPageUrlContent+"/undo.png",href:n})}else typeApiPageI==2?(headerDescriptionName="ARTICLE",headerHtmlBox.PushMenuRow({icon:iPageUrlContent+"/bookmark.png",id:"BookmarkB"}),headerHtmlBox.PushMenuRow({icon:iPageUrlContent+"/undo.png",href:"/"})):typeApiPageI==3&&(headerDescriptionName="SEARCH",placeholder=search.toUpperCase().replaceAll("-"," "),headerHtmlBox.PushMenuRow({icon:iPageUrlContent+"/search.png",href:"",id:"SearchBM"}),headerHtmlBox.PushMenuRow({icon:iPageUrlContent+"/undo.png",href:"/"}));headerHtmlBox.InsertAdjacentHTML(document.getElementsByTagName("body")[0],"afterbegin",HeaderTitle);let idxy="HeaderDescriptionHtmlBox";if(headerDescriptionName.length>0?(new HeaderDescriptionHtmlBox).InsertAdjacentHTML(document.getElementById("HeaderHtmlBox"),"afterend",headerDescriptionName):idxy="HeaderHtmlBox",searchHeaderQHtmlBox.InsertAdjacentHTML(document.getElementById(idxy),"afterend",placeholder),typeApiPageI==1)search.split("-").length>2&&(document.getElementById("SearchHeaderQHtmlBox").style.display="block",document.getElementById("SearchBM").style.display="none");else if(typeApiPageI==2){let n=await ApiArticleBookmarkGet(search.substring(0,search.length-1));n.ok?document.getElementById("BookmarkB").querySelector("img").setAttribute("src",iPageUrlContent+"/bookmarkSelected.png"):document.getElementById("BookmarkB").querySelector("img").setAttribute("src",iPageUrlContent+"/bookmark.png")}else typeApiPageI==3&&(document.getElementById("SearchHeaderQHtmlBox").style.display="block",document.getElementById("SearchBM").style.display="none");let idz="SearchHeaderQHtmlBox";userLogin.length>0&&(headerTitleDescriptionHtmlBox.InsertAdjacentHTML(document.getElementById("SearchHeaderQHtmlBox"),"afterend",userLogin.toUpperCase(),"user profile"),idz=headerTitleDescriptionHtmlBox.Name);let articlesHtmlBox=new ArticlesHtmlBox(document.getElementById(idz),"afterend",search,ApiUrl,Session.Token);await articlesHtmlBox.AppendList();document.getElementById("BookmarkB")!=null&&document.getElementById("BookmarkB").addEventListener("click",async()=>{let n=await ApiArticleBookmarkPost(search.substring(0,search.length-1));n&&(document.getElementById("BookmarkB").querySelector("img").getAttribute("src")==iPageUrlContent+"/bookmark.png"?document.getElementById("BookmarkB").querySelector("img").setAttribute("src",iPageUrlContent+"/bookmarkSelected.png"):document.getElementById("BookmarkB").querySelector("img").setAttribute("src",iPageUrlContent+"/bookmark.png"))});let prevScrollY=window.scrollY;document.addEventListener("scroll",async()=>{window.scrollY>=prevScrollY&&document.body.scrollHeight-window.scrollY<document.body.clientHeight+100&&(prevScrollY=window.scrollY+200,await articlesHtmlBox.AppendList())});document.getElementById("SearchBM").addEventListener("click",async()=>{document.getElementById("SearchBM").style.display="none",document.getElementById("SearchHeaderQHtmlBox").style.display="block"});document.getElementById("SubsribB")!=null&&document.getElementById("SubsribB").addEventListener("click",async()=>{let n=await ApiUserSubscrib(userLogin);n.ok&&(subscribType==0?(subscribType=2,document.querySelector("#SubsribB img").setAttribute("src",iPageUrlContent+"/doubleCheckBlackRed.png")):subscribType==2?(subscribType=0,document.querySelector("#SubsribB img").setAttribute("src",iPageUrlContent+"/doubleCheckBlackBlack.png")):subscribType==3?(subscribType=4,document.querySelector("#SubsribB img").setAttribute("src",iPageUrlContent+"/doubleCheckRedRed.png")):subscribType==4&&(subscribType=3,document.querySelector("#SubsribB img").setAttribute("src",iPageUrlContent+"/doubleCheckRedBlack.png")))});document.querySelector("#"+searchHeaderQHtmlBox.Name+" > a").addEventListener("click",()=>{_SearchFind()});document.querySelector("#"+searchHeaderQHtmlBox.Name+" input").addEventListener("keypress",async n=>{n.key=="Enter"&&_SearchFind()});